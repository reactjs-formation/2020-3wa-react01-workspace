<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Hello React</title>
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>
    
    <script type="text/babel">

        const url = `https://jsonplaceholder.typicode.com/users`;
        

        const App =  (props) => {

            const [data, setData] = React.useState(false);
            const [result, setResult] = React.useState([]);

            React.useEffect( () => {
                
                (async () => {
                    let data = {};
                    data = await fetch(url)
                        .then(response => response.json())
                        .then(response => response)
                        .catch(error => console.log("Erreur : " + error))

                    console.log('data', data)
                    setData(data);

                })();

            }, [])

            let hChange = (e) => {
                setResult(result => [])

                if (e.target.value === '') return;

                for (const key in data) {
                    if (data.hasOwnProperty(key)) {
                        const elm = data[key];
                        const regex = RegExp('.*'+e.target.value+'.*');
                        if (regex.test(elm.name)) {
                            console.log('Test', elm.name)
                            setResult(result => [...result, elm.name])
                        }
                    }
                }
                console.log('length result', result.length)
            }
            
            return <div>
                <div>
                    <input type="text" onChange={hChange} placeholder={'rechercher un nom'} />
                    { (result.length !== 0) && <div>Il y a {result.length} r√©sultats</div>}
                    <ul>
                        {result.map((name, i) => (
                            <li key={i}>{name}</li>
                        ))}
                    </ul>
                </div>
            </div>
        }

        ReactDOM.render(
            <App/>,
            document.getElementById("root")
        );
    </script>
  </body>
</html>